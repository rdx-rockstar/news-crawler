{% load static %}
{% load socialaccount %}
<!DOCTYPE html>
<html>

<head>
	<title>News Crawler</title>
	<!-- for-mobile-apps -->
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content="News Crawler Responsive web template, Bootstrap Web Templates, Flat Web Templates, Android Compatible web template,
Smartphone Compatible web template, free webdesigns for Nokia, Samsung, LG, SonyEricsson, Motorola web design" />
	<script type="application/x-javascript"> addEventListener("load", function() { setTimeout(hideURLbar, 0); }, false);
		function hideURLbar(){ window.scrollTo(0,1); } </script>
	<!-- //for-mobile-apps -->
	<link href="{% static 'css2/bootstrap.css' %}" rel="stylesheet" type="text/css" media="all" />
	<link rel="stylesheet" type="text/css" href="{% static 'css2/zoomslider.css' %}" />
	<link rel="stylesheet" type="text/css" href="{% static 'css2/style.css' %}" />
	<link rel="stylesheet" type="text/css" href="{% static 'css2/component.css' %}" />
	<script type="text/javascript" src="{% static 'js2/modernizr-2.6.2.min.js' %}"></script>
	<!--/web-fonts-->
	<link href='{% static '//fonts.googleapis.com/css?family=Open+Sans:400,600,600italic,300,300italic,700,400italic' %} rel='stylesheet' type='text/css'>
	<link href='{% static '//fonts.googleapis.com/css?family=Wallpoet' %} rel='stylesheet' type='text/css'>
	<link href='{% static '//fonts.googleapis.com/css?family=Ubuntu:400,500,700,300' %} rel='stylesheet' type='text/css'>
	<!--//web-fonts-->
	<style>
		.loader {
			border: 4px solid #f3f3f3; /* Light grey */
			border-top: 4px solid #3498db; /* Blue */
			border-radius: 50%;
			width: 40px;
			height: 40px;
			animation: spin 2s linear infinite;
		  }
		  @keyframes spin {
			0% { transform: rotate(0deg); }
			100% { transform: rotate(360deg); }
		  }
	</style>
	<style>
		.hide-scrollbar::-webkit-scrollbar {
			display: none;
		}
	</style>
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
<script>
    var loader,articles
    window.onload = function(){
        loader=document.getElementById('loader')
        articles=document.getElementById('articles')
        ajax=document.getElementById('crawl')
        reload=document.getElementById('reload')
        loader.style.display='none'
        var loaded=0,myTimer,task_id,unique_id
        ajax.onclick=function(){
            console.log("fetching")
			articles.style.display='none'
            loader.style.display='block'
            //url=document.getElementById("url").value
            loaded=0
            $.ajax({
                url: '/ajax/crawl',
                data: {
                  'url': "https://www.hindustantimes.com/"
                },
                dataType:'json',
                success: function (data) {
                    task_id=data.task_id
                    unique_id=data.unique_id
                    console.log("task id is "+task_id)
                    console.log("unique id is "+unique_id)
                    myTimer = setInterval(status, 5000);
                }
            });
        }
        function loadArticles(){
            window.location.href = "http://localhost:8000/";
            console.log("reloading")
            articles.innerHTML=''
            $.ajax({
                url: '/ajax/load',
                data: {
                    'temp':'temp'
                },
                dataType: 'json',
                success: function (data) {
                    articles.innerHTML+= typeof(Object.entries(data.articles))+" 3"
                    //for( let i=0;i<data.articles.length;i++)
                    //{
                    //    articles.innerHTML+='<div>'+data.articles[i]+'</div>'
                    //}
                    articles.style.display='block'
                    loader.style.display='none'
                }
              });
        }
        function status(){
            if(loaded==1){
                loadArticles()
                clearInterval(myTimer);
                loaded=0
                return
            }
            var ans
            $.ajax({
                url: '/ajax/status',
                data: {
                    'task_id': task_id,
                    'unique_id':unique_id,
                },
                dataType: 'json',
                success: function (data) {
                    console.log('status is '+data.status)
                    if(data.status=='finished'){
                        loadArticles()
                        loaded=1
                    }
                }
              });
        }
        reload.onclick=function(){
            loadArticles()
        }
    }
</script>
</head>

<body>
	<!--/banner-section-->
	<div id="demo-1" data-zs-src='["{% static 'images2/2.jpeg' %}", "{% static 'images2/1.jpeg' %}", "{% static 'images2/3.jpeg' %}", "{% static 'images2/4.jpeg' %}"]'
		data-zs-overlay="dots">
		<div class="demo-inner-content">
			<div class="header-top">
				<!-- /header-left -->
				<div class="header-left">

					<br><div class="tag"><a href = "register">  Register</a></div>
				</div>
				<!-- //header-left -->
				<div class="search-box">
					<div id="sb-search" class="sb-search">

					</div>
					<ul>
					<li><button id="showRight" class="navig" style="color:white"><a href="login">Login </a></button>

<!--
							<!--Navigation from Right To Left-->
						</li>
					</ul>

				</div>

				<div class="clearfix"></div>
			</div>
			<div class="clearfix"></div>
			<div class="banner-info">
				<h1><a href="">News <span class="logo-sub">Crawler</span> </a></h1>
				<form action="">
					<div class="search-two">
						<select id="country" onchange="change_country(this.value)" class="frm-field required">
						<option value="null">Hindustan Times</option>
						<option value="abt">xyz</option>
						<option value="ac">abc</option>
						</select>
					</div>
					<br><br>
					<div class="section_room">
						<label>From:</label>
						<input type="date" id="country4" onchange="change_country(this.value)"
							class="frm-field required">
						</input>
						<label>To:</label>
						<input type="date" id="country5" onchange="change_country(this.value)"
							class="frm-field required">
						</input>
					</div>
					<br><br><br>
					
					<div class="clearfix"></div>
				</form>
				<button id="crawl">CRAWL</button>
			</div>
		</div>
	</div>
	<button id="reload">RELOAD</button>
	<a href="clear"><button>CLEAR</button></a>
	<!--//featured_section-->
	<div class="loader center" id="loader"><br><br><br></div>
	<div id="articles">
	<div class="featured_section_w3l">
		<div class="container">
			<h3 class="tittle">NEWS CATEGORIES</h3>
			<div class="inner_tabs">
				<div class="bs-example bs-example-tabs" role="tabpanel" data-example-id="togglable-tabs">
					<ul id="myTab" class="nav nav-tabs" role="tablist">
						<li role="presentation" class="active"><a href="#" id="expeditions-tab" role="tab"
								data-toggle="tab" aria-controls="expeditions" aria-expanded="true"> UNCLASSIFIED</a>
						</li>
						<li role="presentation"><a href="#" role="tab" id="tours-tab" data-toggle="tab"
								aria-controls="tours">DEFENCE</a></li>
						<li role="presentation"><a href="#tree" role="tab" id="tree-tab" data-toggle="tab"
								aria-controls="tree">NON-DEFENCE</a></li>

					</ul>
					<div id="myTabContent" class="tab-content">
						<div role="tabpanel" class="tab-pane fade in active" id="expeditions"
							aria-labelledby="expeditions-tab">
							<div class="section__content clearfix">
								<!-- /card1 -->
								{% for article in articles %}
									<div class="card">
										<div class="card__front">
											<div class="card-body hide-scrollbar">
												<h3><a href="{{article.url}}" class="blog-desc">{{article.heading}}</a></h3><br>
												<p>
													{{article.description}}
												</p>
											</div>
										</div>
									</div>
								{% endfor %}

								<!-- <div class="card ">
									<div class="card__front">
										<span class="card__text">
											<div class="img-grid">
												<img src="{% static 'images2/f5.jpeg' %}">
											
											</div>
										</span>
									</div>
								</div>

								<div class="card">
									<div class="card__front">
										<span class="card__text">
											<div class="img-grid">
												<img src="{% static 'images2/f5.jpeg' %}">
											
											</div>
										</span>
									</div>
								</div> -->

							</div>
						</div>
					</div>
				</div>
			</div>

		</div>
	</div>
	</div>
	<!--//featured_section-->

			
	<script src="{% static 'js2/jquery-1.11.1.min.js' %}"></script>
	<script type="text/javascript" src="{% static 'js2/jquery.zoomslider.min.js' %}"></script>
	<script type="text/javascript">
		$(window).load(function () {
			$("#flexiselDemo").flexisel({
				visibleItems: 1,
				animationSpeed: 1000,
				autoPlay: true,
				autoPlaySpeed: 1000,
				pauseOnHover: true,
				enableResponsiveBreakpoints: true,
				responsiveBreakpoints: {
					portrait: {
						changePoint: 480,
						visibleItems: 1
					},
					landscape: {
						changePoint: 640,
						visibleItems: 1
					},
					tablet: {
						changePoint: 768,
						visibleItems: 1
					}
				}
			});
		});
	</script>
	<script type="text/javascript">
		$(window).load(function () {
			$("#flexiselDemo1").flexisel({
				visibleItems: 4,
				animationSpeed: 1000,
				autoPlay: true,
				autoPlaySpeed: 3000,
				pauseOnHover: true,
				enableResponsiveBreakpoints: true,
				responsiveBreakpoints: {
					portrait: {
						changePoint: 480,
						visibleItems: 1
					},
					landscape: {
						changePoint: 640,
						visibleItems: 2
					},
					tablet: {
						changePoint: 768,
						visibleItems: 3
					}
				}
			});
		});
	</script>
	<script type="text/javascript" src="{% static 'js2/jquery.flexisel.js' %}"></script>
	<script src="{% static 'js2/bootstrap.js' %}"></script>


</body>

</html>